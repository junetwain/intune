# Read me

My work this time is to deploy applications to Windows endpoint devices using Microsoft Intune.
There's a specific case that I stumble upon, the app called "KakaoTalk". This app is basically WhatsApp but mostly used in Korea.

KakaoTalk checks for update whenever the user opens it. There is no registry parameter (or more precise, no information published online) controlling its autoupdate configurations. The problem rises from here. KakaoTalk always requires local admin permission to update, even when it's installed in user's directory. If I delete Update.exe, it will be automatically generated by KakaoTalk.exe when user runs the program.

There are two directions for this case:
One: provide administrator permission for users. Can use LAPS, but if thousands of endpoints are updating the app at the same time, admins are overflown with requests. It also poses risks for giving regular users admin rights, even when temporarily.
Two: constantly remove update packages and configuration files. To do this, I create a scheduled task, and deploy it with Intune. This scheduled task removes certain update files, and it runs every few minutes after user logon.

Author: Jun

# 1. Remove_Userfiles.ps1
Write a script that remove files in specific user directory. In this case, I need to remove "%UserProfile%\AppData\Local\Kakao\KakaoTalk\KakaoUpdate.exe". Then I deploy this script to endpoint device as an application. The location is: "C:\Program Files (x86)\PBSG Tools\Remove_Userfiles.ps1"

# 2. Create_Schtsk.ps1
This script creates a scheduled task that runs the previous script. Edit the information depending on where you put the previous script.

# 3. Uninstall_Schtsk.ps1
Currently I have no need to remove this scheduled task, so I haven't written this yet. Would add it later if time allows.
